
epoch: 0













































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s296ms | Tot: 10m38s | Loss: 4.925
saving images









































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 997/1000 [02:32<00:00,  6.12it/s]
Saving..
sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:32<00:00,  6.54it/s]
/Users/ethanreid/Documents/DevProjects/Research/DeepHopfieldNetworks/run_unet.py:98: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:276.)
  all_images = torch.Tensor(sample(self.model, image_size=self.image_size,batch_size=1, channels=self.channels))











































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s156ms | Tot: 10m40s | Loss: 0.982
sampling loop time step:   0%|█                                                                                                                                                                                                        | 5/1000 [00:00<02:48,  5.90it/s]











































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 999/1000 [02:31<00:00,  6.70it/s]
Saving..

sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:31<00:00,  6.61it/s]















































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s150ms | Tot: 10m42s | Loss: 0.697
sampling loop time step:   1%|█▌                                                                                                                                                                                                       | 8/1000 [00:01<02:30,  6.59it/s]











































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:30<00:00,  6.64it/s]
Saving..
epoch: 3











































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s152ms | Tot: 10m41s | Loss: 0.535
sampling loop time step:   1%|█▌                                                                                                                                                                                                       | 8/1000 [00:01<02:34,  6.43it/s]










































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:30<00:00,  6.64it/s]
Saving..
epoch: 4












































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s148ms | Tot: 10m41s | Loss: 0.451
sampling loop time step:   1%|█▍                                                                                                                                                                                                       | 7/1000 [00:01<02:29,  6.65it/s]











































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:30<00:00,  6.64it/s]
epoch: 5










































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s141ms | Tot: 10m41s | Loss: 5864.354
sampling loop time step:   0%|▌                                                                                                                                                                                                        | 3/1000 [00:00<02:33,  6.51it/s]











































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:30<00:00,  6.65it/s]
epoch: 6












































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s151ms | Tot: 10m41s | Loss: 176207768931809.000
saving images










































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:29<00:00,  6.70it/s]
epoch: 7











































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s140ms | Tot: 10m39s | Loss: 28476324.017
saving images










































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:29<00:00,  6.68it/s]
epoch: 8













































































































































































































































 [============================ 235/235 ===========================>]  Step: 1s147ms | Tot: 10m39s | Loss: 5311370.784
saving images










































































sampling loop time step: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [02:29<00:00,  6.69it/s]
epoch: 9






































































































 [===========================> 102/235 ............................]  Step: 2s886ms | Tot: 4m36s | Loss: 3253103.794
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x1102a9e40>
Traceback (most recent call last):
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
    self._shutdown_workers()
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/multiprocessing/connection.py", line 930, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
Traceback (most recent call last):
  File "/Users/ethanreid/Documents/DevProjects/Research/DeepHopfieldNetworks/run_unet.py", line 131, in <module>
    manager.train()
  File "/Users/ethanreid/Documents/DevProjects/Research/DeepHopfieldNetworks/run_unet.py", line 77, in train
    loss = p_losses(self.model, batch, t, loss_type="huber")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Research/DeepHopfieldNetworks/diffusion_scripts/diffusion.py", line 57, in p_losses
    predicted_noise = denoise_model(x_noisy)
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1510, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1519, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Research/DeepHopfieldNetworks/diffusion_scripts/unet.py", line 33, in forward
    dEdg, E = torch.func.grad_and_value(self.unet)(x)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/_functorch/vmap.py", line 43, in fn
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 1278, in wrapper
    flat_grad_input = _autograd_grad(flat_outputs, flat_diff_args, create_graph=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/_functorch/eager_transforms.py", line 124, in _autograd_grad
    grad_inputs = torch.autograd.grad(diff_outputs, inputs, grad_outputs,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ethanreid/Documents/DevProjects/Books/advancedDeepLearningWithPython/.venv/lib/python3.11/site-packages/torch/autograd/__init__.py", line 399, in grad
    result = Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt