Rewrite of hamux for pytorch